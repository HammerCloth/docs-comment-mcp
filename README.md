# docs-comment-mcp

MCP (Model Context Protocol) æœåŠ¡å™¨ï¼Œç”¨äºè®© AI èƒ½å¤Ÿæ“ä½œ Word/WPS æ–‡æ¡£ï¼Œæ·»åŠ æ‰¹æ³¨å’Œä¿®è®¢æ¨¡å¼ä¿®æ”¹ã€‚

## åŠŸèƒ½ç‰¹æ€§

### æ‰¹æ³¨åŠŸèƒ½
- âœ… è¯»å– .docx æ–‡æ¡£å†…å®¹å’Œç»“æ„
- âœ… **åœ¨ç‰¹å®šæ–‡æœ¬ï¼ˆå•è¯/å¥å­ï¼‰ä¸Šæ·»åŠ æ‰¹æ³¨ï¼ˆå¿…é¡»æŒ‡å®šï¼‰**
- âœ… **åœ¨æŒ‡å®šå­—ç¬¦ä½ç½®èŒƒå›´æ·»åŠ æ‰¹æ³¨**
- âœ… åˆ—å‡ºæ–‡æ¡£ä¸­çš„æ‰€æœ‰æ‰¹æ³¨
- âœ… **åˆ é™¤æŒ‡å®šçš„æ‰¹æ³¨**
- âš ï¸ **ä¸æ”¯æŒå¯¹æ•´ä¸ªæ®µè½æ·»åŠ æ‰¹æ³¨ï¼ˆå¿…é¡»é€‰æ‹©å…·ä½“æ–‡æœ¬ï¼‰**

### ä¿®è®¢æ¨¡å¼ï¼ˆTrack Changesï¼‰
- âœ… æ’å…¥æ–‡æœ¬ï¼ˆå¸¦ä¿®è®¢æ ‡è®°ï¼‰
- âœ… åˆ é™¤æ–‡æœ¬ï¼ˆå¸¦ä¿®è®¢æ ‡è®°ï¼‰
- âœ… æ›¿æ¢æ–‡æœ¬ï¼ˆæ™ºèƒ½è¯çº§å¯¹æ¯”ï¼‰
- âœ… ä¿®æ”¹æ•´ä¸ªæ®µè½ï¼ˆæ™ºèƒ½è¯çº§å¯¹æ¯”ï¼‰
- âœ… åˆ—å‡ºæ‰€æœ‰ä¿®è®¢è®°å½•
- âœ… è‡ªå®šä¹‰ä½œè€…å’Œæ—¶é—´æˆ³
- âœ… **è¯çº§ä¿®è®¢**ï¼šæŒ‰è¯æˆ–çŸ­è¯­åˆ†ç»„ä¿®è®¢ï¼Œæ¨¡æ‹Ÿäººç±»è‡ªç„¶çš„ä¿®æ”¹æ–¹å¼

### AI æ™ºèƒ½å®¡é˜…
- âœ… **suggest_revision å·¥å…·**ï¼šAI åƒäººç±»å®¡é˜…è€…ä¸€æ ·æå‡ºä¿®æ”¹å»ºè®®
  - æŒ‡å‡ºå…·ä½“éœ€è¦ä¿®æ”¹çš„æ–‡æœ¬ç‰‡æ®µ
  - æä¾›å»ºè®®çš„æ›¿æ¢å†…å®¹
  - è§£é‡Šä¿®æ”¹åŸå› ï¼ˆè¯­æ³•é”™è¯¯ã€ç”¨è¯ä¸å½“ã€è¡¨è¾¾ä¸æ¸…ç­‰ï¼‰
  - å¯é€‰æ‹©ç«‹å³åº”ç”¨æˆ–ä»…ä½œä¸ºå»ºè®®ä¾›å®¡é˜…
  - ä½¿ç”¨è‡ªç„¶çš„è¯çº§å¯¹æ¯”ï¼Œè€Œéæœºæ¢°çš„é€å­—å¯¹æ¯”

### å…¼å®¹æ€§
- âœ… å®Œå…¨å…¼å®¹ Word 2016+ å’Œ WPS 2019+
- âœ… æ”¯æŒä¸­æ–‡å†…å®¹å’Œæ‰¹æ³¨
- âœ… ä¿®è®¢å¯åœ¨ Word/WPS ä¸­æ¥å—æˆ–æ‹’ç»

## å®‰è£…

### å‰ç½®è¦æ±‚

- Node.js 18 æˆ–æ›´é«˜ç‰ˆæœ¬
- npm æˆ– yarn

### æ–¹å¼ä¸€ï¼šé€šè¿‡ npx ç›´æ¥ä½¿ç”¨ï¼ˆæ¨èï¼‰

æ— éœ€å®‰è£…ï¼Œç›´æ¥åœ¨ Claude Desktop é…ç½®ä¸­ä½¿ç”¨ï¼š

**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

```json
{
  "mcpServers": {
    "docs-comment": {
      "command": "npx",
      "args": ["-y", "docs-comment-mcp"]
    }
  }
}
```

### æ–¹å¼äºŒï¼šå…¨å±€å®‰è£…

```bash
npm install -g docs-comment-mcp
```

é…ç½®æ–‡ä»¶ï¼š

```json
{
  "mcpServers": {
    "docs-comment": {
      "command": "docs-comment-mcp"
    }
  }
}
```

### æ–¹å¼ä¸‰ï¼šä»æºç å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/HammerCloth/docs-comment-mcp.git
cd docs-comment-mcp

# å®‰è£…ä¾èµ–
npm install
# å¦‚æœç½‘ç»œé—®é¢˜ï¼Œå¯ä½¿ç”¨æ·˜å®é•œåƒï¼š
# npm install --registry=https://registry.npmmirror.com

# æ„å»ºé¡¹ç›®
npm run build

# å…¨å±€å®‰è£…ï¼ˆå¯é€‰ï¼‰
npm install -g .
```

## é…ç½®

### Claude Desktop é…ç½®

åœ¨ Claude Desktop çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ­¤ MCP æœåŠ¡å™¨ï¼š

**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

```json
{
  "mcpServers": {
    "docs-comment": {
      "command": "node",
      "args": ["/path/to/docs-comment-mcp/dist/index.js"]
    }
  }
}
```

å¦‚æœå…¨å±€å®‰è£…ï¼Œå¯ä»¥ç®€åŒ–ä¸ºï¼š

```json
{
  "mcpServers": {
    "docs-comment": {
      "command": "docs-comment-mcp"
    }
  }
}
```

## ä½¿ç”¨æ–¹æ³•

### 1. è¯»å–æ–‡æ¡£

```
User: è¯·è¯»å– /path/to/document.docx æ–‡ä»¶

Claude: [è°ƒç”¨ read_document å·¥å…·]
æ–‡æ¡£åŒ…å« 10 ä¸ªæ®µè½ï¼š
1. æ ‡é¢˜ï¼šIntroduction
2. æ­£æ–‡ï¼šThis is the first paragraph...
...
```

### 2. æ·»åŠ æ‰¹æ³¨

**é‡è¦æç¤º**ï¼šæ·»åŠ æ‰¹æ³¨æ—¶å¿…é¡»æŒ‡å®šå…·ä½“çš„æ–‡æœ¬æˆ–å­—ç¬¦ä½ç½®èŒƒå›´ï¼Œä¸èƒ½å¯¹æ•´ä¸ªæ®µè½æ·»åŠ æ‰¹æ³¨ã€‚

#### 2.1 å¯¹ç‰¹å®šæ–‡å­—æ·»åŠ æ‰¹æ³¨

```
User: åœ¨ç¬¬ 2 æ®µçš„ "é‡è¦æ•°æ®" è¿™å‡ ä¸ªå­—ä¸Šæ·»åŠ æ‰¹æ³¨ï¼š"éœ€è¦æ ¸å®å‡†ç¡®æ€§"

Claude: [è°ƒç”¨ add_comment å·¥å…·ï¼ŒæŒ‡å®š text å‚æ•°]
å·²æˆåŠŸæ·»åŠ æ‰¹æ³¨ï¼š
- æ‰¹æ³¨ ID: d2e3f4g5-h6i7-8j9k-0l1m-2n3o4p5q6r7s
- ä½ç½®ï¼šç¬¬ 2 æ®µï¼Œæ–‡æœ¬ "é‡è¦æ•°æ®"
- å†…å®¹ï¼šéœ€è¦æ ¸å®å‡†ç¡®æ€§
- ä½œè€…ï¼šAI Assistant
```

#### 2.2 å¯¹å­—ç¬¦ä½ç½®èŒƒå›´æ·»åŠ æ‰¹æ³¨

```
User: åœ¨ç¬¬ 1 æ®µçš„ç¬¬ 10 åˆ° 25 ä¸ªå­—ç¬¦ä½ç½®æ·»åŠ æ‰¹æ³¨ï¼š"è¿™éƒ¨åˆ†è¡¨è¿°ä¸æ¸…"

Claude: [è°ƒç”¨ add_comment å·¥å…·ï¼ŒæŒ‡å®š start_pos å’Œ end_pos]
å·²æˆåŠŸæ·»åŠ æ‰¹æ³¨ï¼š
- æ‰¹æ³¨ ID: e3f4g5h6-i7j8-9k0l-1m2n-3o4p5q6r7s8t
- ä½ç½®ï¼šç¬¬ 1 æ®µï¼Œå­—ç¬¦ä½ç½® 10-25
- å†…å®¹ï¼šè¿™éƒ¨åˆ†è¡¨è¿°ä¸æ¸…
- ä½œè€…ï¼šAI Assistant
```

### 3. åˆ—å‡ºæ‰¹æ³¨

```
User: åˆ—å‡ºæ–‡æ¡£ä¸­çš„æ‰€æœ‰æ‰¹æ³¨

Claude: [è°ƒç”¨ list_comments å·¥å…·]
æ–‡æ¡£åŒ…å« 2 ä¸ªæ‰¹æ³¨ï¼š
1. [ç¬¬ 3 æ®µ] éœ€è¦è¡¥å……æ•°æ®æ¥æº (AI Assistant) - ID: c1a2b3c4-d5e6-7f8g-9h0i-1j2k3l4m5n6o
2. [ç¬¬ 5 æ®µ] å»ºè®®æ·»åŠ å¼•ç”¨ (AI Assistant) - ID: d2e3f4g5-h6i7-8j9k-0l1m-2n3o4p5q6r7s
```

### 4. åˆ é™¤æ‰¹æ³¨

```
User: åˆ é™¤ ID ä¸º c1a2b3c4-d5e6-7f8g-9h0i-1j2k3l4m5n6o çš„æ‰¹æ³¨

Claude: [è°ƒç”¨ delete_comment å·¥å…·]
å·²æˆåŠŸåˆ é™¤æ‰¹æ³¨ï¼š
- æ‰¹æ³¨ ID: c1a2b3c4-d5e6-7f8g-9h0i-1j2k3l4m5n6o
- çŠ¶æ€ï¼šå·²ä»æ–‡æ¡£ä¸­ç§»é™¤
```

### 4. æ’å…¥æ–‡æœ¬ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰

```
User: åœ¨ç¬¬ 2 æ®µæ’å…¥æ–‡æœ¬ "é‡è¦æç¤ºï¼š"ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼

Claude: [è°ƒç”¨ insert_text å·¥å…·]
å·²æˆåŠŸæ’å…¥æ–‡æœ¬ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰ï¼š
- ä¿®è®¢ ID: abc123...
- ä½ç½®ï¼šç¬¬ 2 æ®µ
- æ–‡æœ¬ï¼šé‡è¦æç¤ºï¼š
- ä½œè€…ï¼šAI Assistant
- çŠ¶æ€ï¼šå¾…å®¡æ ¸ï¼ˆå¯åœ¨ Word ä¸­æ¥å—æˆ–æ‹’ç»ï¼‰
```

### 5. åˆ é™¤æ–‡æœ¬ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰

```
User: åˆ é™¤ç¬¬ 3 æ®µä¸­çš„ "ä¸´æ—¶æ•°æ®" æ–‡æœ¬ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼

Claude: [è°ƒç”¨ delete_text å·¥å…·]
å·²æ ‡è®°åˆ é™¤ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰ï¼š
- ä¿®è®¢ ID: def456...
- ä½ç½®ï¼šç¬¬ 3 æ®µ
- åˆ é™¤æ–‡æœ¬ï¼šä¸´æ—¶æ•°æ®
- ä½œè€…ï¼šAI Assistant
- çŠ¶æ€ï¼šå¾…å®¡æ ¸ï¼ˆå¯åœ¨ Word ä¸­æ¥å—æˆ–æ‹’ç»ï¼‰
```

### 6. æ›¿æ¢æ–‡æœ¬ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰

```
User: å°†ç¬¬ 1 æ®µçš„ "åˆç¨¿" æ›¿æ¢ä¸º "æ­£å¼ç‰ˆæœ¬"ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼

Claude: [è°ƒç”¨ replace_text å·¥å…·]
å·²å®Œæˆæ›¿æ¢ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰ï¼š
- åˆ é™¤ï¼šåˆç¨¿
- æ’å…¥ï¼šæ­£å¼ç‰ˆæœ¬
- ä½ç½®ï¼šç¬¬ 1 æ®µ
- ä½œè€…ï¼šAI Assistant
- çŠ¶æ€ï¼šå¾…å®¡æ ¸ï¼ˆå¯åœ¨ Word ä¸­æ¥å—æˆ–æ‹’ç»ï¼‰
```

### 7. ä¿®æ”¹æ®µè½ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰

```
User: å°†ç¬¬ 5 æ®µä¿®æ”¹ä¸º "è¿™æ˜¯æ›´æ–°åçš„æ®µè½å†…å®¹"ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼

Claude: [è°ƒç”¨ modify_paragraph å·¥å…·]
å·²ä¿®æ”¹æ®µè½ï¼ˆä¿®è®¢æ¨¡å¼ï¼‰ï¼š
- ä½ç½®ï¼šç¬¬ 5 æ®µ
- æ—§å†…å®¹å·²æ ‡è®°åˆ é™¤
- æ–°å†…å®¹å·²æ ‡è®°æ’å…¥
- ä½œè€…ï¼šAI Assistant
- çŠ¶æ€ï¼šå¾…å®¡æ ¸ï¼ˆå¯åœ¨ Word ä¸­æ¥å—æˆ–æ‹’ç»ï¼‰
```

### 8. åˆ—å‡ºæ‰€æœ‰ä¿®è®¢

```
User: åˆ—å‡ºæ–‡æ¡£ä¸­çš„æ‰€æœ‰ä¿®è®¢è®°å½•

Claude: [è°ƒç”¨ list_revisions å·¥å…·]
æ–‡æ¡£åŒ…å« 3 ä¸ªä¿®è®¢ï¼š
1. [æ’å…¥] ç¬¬ 2 æ®µ - "é‡è¦æç¤ºï¼š" (AI Assistant)
2. [åˆ é™¤] ç¬¬ 3 æ®µ - "ä¸´æ—¶æ•°æ®" (AI Assistant)
3. [æ’å…¥] ç¬¬ 1 æ®µ - "æ­£å¼ç‰ˆæœ¬" (AI Assistant)
```

## MCP å·¥å…·

æœ¬ MCP æœåŠ¡å™¨æä¾›ä»¥ä¸‹ä¸‰ç±»å·¥å…·ï¼š

### ğŸ“„ æ–‡æ¡£è¯»å–å·¥å…·

#### read_document

è¯»å– .docx æ–‡ä»¶çš„å†…å®¹å’Œç»“æ„ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„

**è¿”å›**:
```json
{
  "success": true,
  "data": {
    "file_path": "/path/to/document.docx",
    "paragraphs": [
      {
        "index": 0,
        "text": "Introduction",
        "style": "Heading1"
      }
    ],
    "total_paragraphs": 10,
    "has_comments": true,
    "comment_count": 2
  }
}
```

### ğŸ’¬ è¯„è®ºç®¡ç†å·¥å…·

#### add_comment

åœ¨æ®µè½ä¸­çš„ç‰¹å®šæ–‡æœ¬ä¸Šæ·»åŠ æ‰¹æ³¨ã€‚**å¿…é¡»æŒ‡å®šå…·ä½“çš„æ–‡æœ¬æˆ–å­—ç¬¦ä½ç½®èŒƒå›´**ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
- `comment_text` (string, å¿…éœ€): æ‰¹æ³¨å†…å®¹
- `paragraph_index` (number, å¿…éœ€): æ®µè½ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `text` (string, æ¡ä»¶å¿…éœ€): è¦æ‰¹æ³¨çš„å…·ä½“æ–‡æœ¬ï¼ˆå•è¯æˆ–å¥å­ï¼‰ã€‚å¦‚æœä¸æä¾›æ­¤å‚æ•°ï¼Œåˆ™å¿…é¡»æä¾› start_pos å’Œ end_pos
- `start_pos` (number, æ¡ä»¶å¿…éœ€): å­—ç¬¦èµ·å§‹ä½ç½®ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚å¿…é¡»ä¸ end_pos ä¸€èµ·ä½¿ç”¨
- `end_pos` (number, æ¡ä»¶å¿…éœ€): å­—ç¬¦ç»“æŸä½ç½®ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚å¿…é¡»ä¸ start_pos ä¸€èµ·ä½¿ç”¨
- `author` (string, å¯é€‰): æ‰¹æ³¨ä½œè€…ï¼Œé»˜è®¤ "AI Assistant"
- `initials` (string, å¯é€‰): ä½œè€…ç¼©å†™ï¼Œé»˜è®¤ "AI"

**ä½¿ç”¨è¯´æ˜**:
- **å¿…é¡»æä¾›** `text` å‚æ•° **æˆ–è€…** åŒæ—¶æä¾› `start_pos` å’Œ `end_pos` å‚æ•°
- å¦‚æœæä¾› `text`ï¼šåœ¨æ®µè½ä¸­æŸ¥æ‰¾è¯¥æ–‡æœ¬å¹¶æ·»åŠ æ‰¹æ³¨
- å¦‚æœæä¾› `start_pos` å’Œ `end_pos`ï¼šåœ¨æŒ‡å®šå­—ç¬¦èŒƒå›´æ·»åŠ æ‰¹æ³¨
- **ä¸æ”¯æŒå¯¹æ•´ä¸ªæ®µè½æ·»åŠ æ‰¹æ³¨**

**è¿”å›**:
```json
{
  "success": true,
  "data": {
    "comment_id": "c1a2b3c4-d5e6-7f8g-9h0i-1j2k3l4m5n6o",
    "paragraph_index": 3,
    "comment_text": "éœ€è¦è¡¥å……æ•°æ®æ¥æº",
    "author": "AI Assistant",
    "initials": "AI",
    "created_at": "2026-02-07T10:30:00.000Z"
  }
}
```

### list_comments

åˆ—å‡ºæ–‡æ¡£ä¸­çš„æ‰€æœ‰æ‰¹æ³¨ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„

**è¿”å›**:
```json
{
  "success": true,
  "data": {
    "file_path": "/path/to/document.docx",
    "comments": [
      {
        "comment_id": "c1a2b3c4-d5e6-7f8g-9h0i-1j2k3l4m5n6o",
        "paragraph_index": 3,
        "comment_text": "éœ€è¦è¡¥å……æ•°æ®æ¥æº",
        "author": "AI Assistant",
        "initials": "AI",
        "created_at": "2026-02-07T10:30:00.000Z"
      }
    ],
    "total_comments": 1
  }
}
```

### delete_comment

åˆ é™¤æ–‡æ¡£ä¸­çš„æŒ‡å®šæ‰¹æ³¨ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
- `comment_id` (string, å¿…éœ€): è¦åˆ é™¤çš„æ‰¹æ³¨ IDï¼ˆä» list_comments è·å–ï¼‰

**è¿”å›**:
```json
{
  "success": true,
  "data": {
    "success": true,
    "comment_id": "c1a2b3c4-d5e6-7f8g-9h0i-1j2k3l4m5n6o"
  }
}
```

### âœï¸ ä¿®è®¢æ¨¡å¼å·¥å…·ï¼ˆTrack Changesï¼‰

#### insert_text

åœ¨æ–‡æ¡£ä¸­æ’å…¥æ–‡æœ¬ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼æ ‡è®°ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
- `paragraph_index` (number, å¿…éœ€): æ®µè½ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `text` (string, å¿…éœ€): è¦æ’å…¥çš„æ–‡æœ¬
- `position` (number, å¯é€‰): æ’å…¥ä½ç½®ï¼Œé»˜è®¤ä¸ºæ®µè½æœ«å°¾
- `author` (string, å¯é€‰): ä½œè€…åç§°ï¼Œé»˜è®¤ "AI Assistant"
- `date` (string, å¯é€‰): ISO æ—¥æœŸå­—ç¬¦ä¸²ï¼Œé»˜è®¤å½“å‰æ—¶é—´

**è¿”å›**:
```json
{
  "revision_id": "abc123...",
  "revision_type": "insert",
  "paragraph_index": 2,
  "text": "é‡è¦æç¤ºï¼š",
  "author": "AI Assistant",
  "date": "2026-02-07T12:00:00.000Z"
}
```

#### delete_text

åˆ é™¤æ–‡æ¡£ä¸­çš„æ–‡æœ¬ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼æ ‡è®°ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
- `paragraph_index` (number, å¿…éœ€): æ®µè½ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `text` (string, å¿…éœ€): è¦åˆ é™¤çš„æ–‡æœ¬ï¼ˆå¿…é¡»ç²¾ç¡®åŒ¹é…ï¼‰
- `author` (string, å¯é€‰): ä½œè€…åç§°ï¼Œé»˜è®¤ "AI Assistant"
- `date` (string, å¯é€‰): ISO æ—¥æœŸå­—ç¬¦ä¸²ï¼Œé»˜è®¤å½“å‰æ—¶é—´

**è¿”å›**:
```json
{
  "revision_id": "def456...",
  "revision_type": "delete",
  "paragraph_index": 3,
  "text": "ä¸´æ—¶æ•°æ®",
  "author": "AI Assistant",
  "date": "2026-02-07T12:00:00.000Z"
}
```

#### replace_text

æ›¿æ¢æ–‡æ¡£ä¸­çš„æ–‡æœ¬ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼æ ‡è®°ï¼ˆåˆ é™¤æ—§æ–‡æœ¬ + æ’å…¥æ–°æ–‡æœ¬ï¼‰ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
- `paragraph_index` (number, å¿…éœ€): æ®µè½ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `old_text` (string, å¿…éœ€): è¦æ›¿æ¢çš„æ–‡æœ¬ï¼ˆå¿…é¡»ç²¾ç¡®åŒ¹é…ï¼‰
- `new_text` (string, å¿…éœ€): æ–°æ–‡æœ¬
- `author` (string, å¯é€‰): ä½œè€…åç§°ï¼Œé»˜è®¤ "AI Assistant"
- `date` (string, å¯é€‰): ISO æ—¥æœŸå­—ç¬¦ä¸²ï¼Œé»˜è®¤å½“å‰æ—¶é—´

**è¿”å›**:
```json
{
  "delete": {
    "revision_id": "ghi789...",
    "revision_type": "delete",
    "paragraph_index": 1,
    "text": "åˆç¨¿",
    "author": "AI Assistant",
    "date": "2026-02-07T12:00:00.000Z"
  },
  "insert": {
    "revision_id": "jkl012...",
    "revision_type": "insert",
    "paragraph_index": 1,
    "text": "æ­£å¼ç‰ˆæœ¬",
    "author": "AI Assistant",
    "date": "2026-02-07T12:00:00.000Z"
  }
}
```

#### modify_paragraph

ä¿®æ”¹æ•´ä¸ªæ®µè½ï¼Œä½¿ç”¨ä¿®è®¢æ¨¡å¼æ ‡è®°ï¼ˆåˆ é™¤æ—§å†…å®¹ + æ’å…¥æ–°å†…å®¹ï¼‰ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
- `paragraph_index` (number, å¿…éœ€): æ®µè½ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `new_text` (string, å¿…éœ€): æ–°çš„æ®µè½æ–‡æœ¬
- `author` (string, å¯é€‰): ä½œè€…åç§°ï¼Œé»˜è®¤ "AI Assistant"
- `date` (string, å¯é€‰): ISO æ—¥æœŸå­—ç¬¦ä¸²ï¼Œé»˜è®¤å½“å‰æ—¶é—´

**è¿”å›**:
```json
{
  "delete": {
    "revision_id": "mno345...",
    "revision_type": "delete",
    "paragraph_index": 5,
    "text": "æ—§çš„æ®µè½å†…å®¹",
    "author": "AI Assistant",
    "date": "2026-02-07T12:00:00.000Z"
  },
  "insert": {
    "revision_id": "pqr678...",
    "revision_type": "insert",
    "paragraph_index": 5,
    "text": "è¿™æ˜¯æ›´æ–°åçš„æ®µè½å†…å®¹",
    "author": "AI Assistant",
    "date": "2026-02-07T12:00:00.000Z"
  }
}
```

#### list_revisions

åˆ—å‡ºæ–‡æ¡£ä¸­çš„æ‰€æœ‰ä¿®è®¢è®°å½•ã€‚

**è¾“å…¥å‚æ•°**:
- `file_path` (string, å¿…éœ€): æ–‡ä»¶çš„ç»å¯¹è·¯å¾„

**è¿”å›**:
```json
[
  {
    "revision_id": "abc123...",
    "revision_type": "insert",
    "paragraph_index": 2,
    "text": "é‡è¦æç¤ºï¼š",
    "author": "AI Assistant",
    "date": "2026-02-07T12:00:00.000Z"
  },
  {
    "revision_id": "def456...",
    "revision_type": "delete",
    "paragraph_index": 3,
    "text": "ä¸´æ—¶æ•°æ®",
    "author": "AI Assistant",
    "date": "2026-02-07T12:00:00.000Z"
  }
]
```

## å¼€å‘

### é¡¹ç›®ç»“æ„

```
docs-comment-mcp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ server.ts             # MCP æœåŠ¡å™¨å®ç°
â”‚   â”œâ”€â”€ tools/                # MCP å·¥å…·
â”‚   â”‚   â”œâ”€â”€ read-document.ts
â”‚   â”‚   â”œâ”€â”€ add-comment.ts
â”‚   â”‚   â””â”€â”€ list-comments.ts
â”‚   â”œâ”€â”€ services/             # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ document-service.ts
â”‚   â”œâ”€â”€ types/                # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ validation.ts
â”‚       â””â”€â”€ error-handler.ts
â”œâ”€â”€ tests/                    # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ dist/                     # ç¼–è¯‘è¾“å‡º
â””â”€â”€ package.json
```

### å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰
npm run dev

# æ„å»º
npm run build

# è¿è¡Œæµ‹è¯•
npm run test

# ä»£ç æ£€æŸ¥
npm run lint

# ä»£ç æ ¼å¼åŒ–
npm run format
```

## æŠ€æœ¯æ ˆ

- **è¯­è¨€**: TypeScript
- **è¿è¡Œæ—¶**: Node.js 18+
- **MCP SDK**: @modelcontextprotocol/sdk
- **æ–‡æ¡£å¤„ç†**: docx
- **å…¶ä»–**: jszip, xml2js, uuid

## å…¼å®¹æ€§

- âœ… Word 2016+
- âœ… WPS 2019+
- âœ… macOS, Windows, Linux
- âœ… ä¸­æ–‡å†…å®¹æ”¯æŒ

## é™åˆ¶

å½“å‰ MVP ç‰ˆæœ¬çš„é™åˆ¶ï¼š

- ä»…æ”¯æŒ .docx æ ¼å¼ï¼ˆä¸æ”¯æŒ .docï¼‰
- æ‰¹æ³¨æ·»åŠ åœ¨æ®µè½çº§åˆ«ï¼ˆä¸æ”¯æŒå­—ç¬¦çº§åˆ«ï¼‰
- ä¸æ”¯æŒæ‰¹æ³¨å›å¤åŠŸèƒ½
- ä¸æ”¯æŒæ‰¹æ³¨æ ·å¼è‡ªå®šä¹‰

## æœªæ¥è®¡åˆ’

- [ ] æ”¯æŒåˆ é™¤å’Œä¿®æ”¹æ‰¹æ³¨
- [ ] æ”¯æŒæ‰¹æ³¨å›å¤
- [ ] æ”¯æŒå­—ç¬¦çº§åˆ«æ‰¹æ³¨
- [ ] æ”¯æŒ .doc æ ¼å¼
- [ ] æ‰¹æ³¨æ ·å¼è‡ªå®šä¹‰

## è®¸å¯è¯

Apache-2.0

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·åœ¨ GitHub æäº¤ Issueï¼šhttps://github.com/HammerCloth/docs-comment-mcp/issues

## ä»“åº“

- GitHub: https://github.com/HammerCloth/docs-comment-mcp
- ä½œè€…: HammerCloth
